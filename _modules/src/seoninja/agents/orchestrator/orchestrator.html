<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>src.seoninja.agents.orchestrator.orchestrator &mdash; SEO Ninja 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css?v=eafc0fe6" />

  
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../../_static/documentation_options.js?v=8d563738"></script>
        <script src="../../../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../index.html" class="icon icon-home">
            SEO Ninja
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../introduction.html#what-is-seo-ninja">What is SEO Ninja?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../introduction.html#key-features">Key Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../introduction.html#system-architecture">System Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../introduction.html#core-components">Core Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../introduction.html#communication-flow">Communication Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../introduction.html#task-management">Task Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../introduction.html#state-management">State Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../introduction.html#error-handling">Error Handling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../introduction.html#technology-stack">Technology Stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../introduction.html#getting-started">Getting Started</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../installation.html">Installation Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../installation.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../installation.html#required-api-keys">Required API Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../installation.html#installation-steps">Installation Steps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../installation.html#clone-the-repository">1. Clone the Repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../installation.html#create-virtual-environment">2. Create Virtual Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../installation.html#install-dependencies">3. Install Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../installation.html#configure-environment-variables">4. Configure Environment Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../installation.html#set-up-google-search-console-authentication">5. Set Up Google Search Console Authentication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../installation.html#running-the-application">Running the Application</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../installation.html#start-the-api-server">1. Start the API Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../installation.html#access-the-api-documentation">2. Access the API Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../installation.html#development-setup">Development Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../installation.html#install-development-dependencies">1. Install Development Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../installation.html#set-up-pre-commit-hooks">2. Set Up Pre-commit Hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../installation.html#run-tests">3. Run Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../installation.html#build-documentation">4. Build Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../installation.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../installation.html#common-issues">Common Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../installation.html#getting-help">Getting Help</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../architecture.html">Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../architecture.html#system-overview">System Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../architecture.html#core-components">Core Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../architecture.html#orchestrator-agent">Orchestrator Agent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../architecture.html#specialized-agents">Specialized Agents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../architecture.html#communication-model">Communication Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../architecture.html#inter-agent-communication">Inter-agent Communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../architecture.html#message-types">Message Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../architecture.html#task-processing">Task Processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../architecture.html#task-lifecycle">Task Lifecycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../architecture.html#parallel-processing">Parallel Processing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../architecture.html#resource-management">Resource Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../architecture.html#resource-types">Resource Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../architecture.html#monitoring-system">Monitoring System</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../architecture.html#security-architecture">Security Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../architecture.html#authentication">Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../architecture.html#data-protection">Data Protection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../architecture.html#error-handling">Error Handling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../architecture.html#recovery-mechanisms">Recovery Mechanisms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../architecture.html#error-propagation">Error Propagation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../architecture.html#deployment-architecture">Deployment Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../architecture.html#components">Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../architecture.html#scaling-strategy">Scaling Strategy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../architecture.html#future-considerations">Future Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../architecture.html#planned-enhancements">Planned Enhancements</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../api/index.html">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api/index.html#task-management">Task Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api/index.html#agent-communication">Agent Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api/index.html#process-timeline">Process Timeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api/index.html#resource-monitoring">Resource Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api/index.html#system-status">System Status</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../api/index.html#error-responses">Error Responses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../monitoring.html">Monitoring and Analytics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../monitoring.html#agent-communication-visualization">Agent Communication Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../monitoring.html#flow-analysis">Flow Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../monitoring.html#real-time-monitoring">Real-time Monitoring</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../monitoring.html#process-timeline">Process Timeline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../monitoring.html#stage-tracking">Stage Tracking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../monitoring.html#decision-points">Decision Points</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../monitoring.html#resource-monitoring">Resource Monitoring</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../monitoring.html#resource-allocation">Resource Allocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../monitoring.html#usage-patterns">Usage Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../monitoring.html#bottleneck-detection">Bottleneck Detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../monitoring.html#system-capacity">System Capacity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../monitoring.html#visualization-integration">Visualization Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../monitoring.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../changelog.html#id1">[1.0.0] - 2024-02-04</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../changelog.html#added">Added</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../changelog.html#id2">[0.9.0] - 2024-01-15</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../changelog.html#id3">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../changelog.html#changed">Changed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../changelog.html#id4">[0.8.0] - 2023-12-20</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../changelog.html#id5">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../changelog.html#fixed">Fixed</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../autoapi/index.html">API Reference</a><ul class="simple">
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">SEO Ninja</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">src.seoninja.agents.orchestrator.orchestrator</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for src.seoninja.agents.orchestrator.orchestrator</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Orchestrator agent for coordinating specialized agents.&quot;&quot;&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">...agents.base.agent</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseAgent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">...agents.specialized.content_agent</span><span class="w"> </span><span class="kn">import</span> <span class="n">ContentAgent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">...agents.specialized.seo_optimizer</span><span class="w"> </span><span class="kn">import</span> <span class="n">SEOOptimizerAgent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">...agents.specialized.crawler_agent</span><span class="w"> </span><span class="kn">import</span> <span class="n">CrawlerAgent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">...agents.specialized.keyword_agent</span><span class="w"> </span><span class="kn">import</span> <span class="n">KeywordResearchAgent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">...utils.storage</span><span class="w"> </span><span class="kn">import</span> <span class="n">PersistentStorage</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">...utils.security</span><span class="w"> </span><span class="kn">import</span> <span class="n">APIKeyManager</span><span class="p">,</span> <span class="n">RateLimiter</span><span class="p">,</span> <span class="n">InputValidator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">...utils.parallel</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_parallel_tasks</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">...config.settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_settings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>

<div class="viewcode-block" id="TaskDecomposer">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/agents/orchestrator/orchestrator/index.html#src.seoninja.agents.orchestrator.orchestrator.TaskDecomposer">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TaskDecomposer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decomposes complex tasks into subtasks with enhanced context sharing.&quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_dependencies</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;website_analysis&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;crawl&#39;</span><span class="p">,</span> <span class="s1">&#39;analyze_content&#39;</span><span class="p">,</span> <span class="s1">&#39;keyword_research&#39;</span><span class="p">],</span>
            <span class="s1">&#39;content_generation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;keyword_research&#39;</span><span class="p">,</span> <span class="s1">&#39;generate&#39;</span><span class="p">,</span> <span class="s1">&#39;optimize&#39;</span><span class="p">],</span>
            <span class="s1">&#39;content_optimization&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;technical_seo&#39;</span><span class="p">,</span> <span class="s1">&#39;analyze&#39;</span><span class="p">,</span> <span class="s1">&#39;intent&#39;</span><span class="p">]</span>
        <span class="p">}</span>
        
<div class="viewcode-block" id="TaskDecomposer.decompose_task">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/agents/orchestrator/orchestrator/index.html#src.seoninja.agents.orchestrator.orchestrator.TaskDecomposer.decompose_task">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">decompose_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">shared_context</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Decompose task into subtasks with context preservation.&quot;&quot;&quot;</span>
        <span class="n">subtasks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">task_context</span> <span class="o">=</span> <span class="n">shared_context</span> <span class="ow">or</span> <span class="p">{}</span>
        
        <span class="k">if</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;website_analysis&#39;</span><span class="p">:</span>
            <span class="c1"># Sequential crawl and analysis</span>
            <span class="n">crawl_task</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;crawl&#39;</span><span class="p">,</span>
                <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">],</span>
                <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;depth&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="s1">&#39;crawler&#39;</span><span class="p">,</span>
                <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="n">task_context</span>
            <span class="p">}</span>
            <span class="n">crawl_result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_subtask</span><span class="p">(</span><span class="n">crawl_task</span><span class="p">)</span>
            <span class="n">task_context</span><span class="p">[</span><span class="s1">&#39;crawl_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crawl_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span>
            
            <span class="n">subtasks</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
                <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;analyze_content&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="s1">&#39;content&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="n">task_context</span><span class="p">,</span>
                    <span class="s1">&#39;dependencies&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;crawl&#39;</span><span class="p">]</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;keyword_research&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;domain&#39;</span><span class="p">:</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="s1">&#39;keyword&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="n">task_context</span><span class="p">,</span>
                    <span class="s1">&#39;dependencies&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;crawl&#39;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">])</span>
            
        <span class="k">elif</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;content_generation&#39;</span><span class="p">:</span>
            <span class="c1"># Sequential keyword research and content generation</span>
            <span class="n">keyword_task</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;keyword_research&#39;</span><span class="p">,</span>
                <span class="s1">&#39;keyword&#39;</span><span class="p">:</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;keyword&#39;</span><span class="p">],</span>
                <span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="s1">&#39;keyword&#39;</span><span class="p">,</span>
                <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="n">task_context</span>
            <span class="p">}</span>
            <span class="n">keyword_result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_subtask</span><span class="p">(</span><span class="n">keyword_task</span><span class="p">)</span>
            <span class="n">task_context</span><span class="p">[</span><span class="s1">&#39;keyword_data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">keyword_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span>
            
            <span class="n">subtasks</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
                <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;generate&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;keyword_data&#39;</span><span class="p">:</span> <span class="n">task_context</span><span class="p">[</span><span class="s1">&#39;keyword_data&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="s1">&#39;content&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="n">task_context</span><span class="p">,</span>
                    <span class="s1">&#39;dependencies&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;keyword_research&#39;</span><span class="p">]</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;optimize&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;keyword_data&#39;</span><span class="p">:</span> <span class="n">task_context</span><span class="p">[</span><span class="s1">&#39;keyword_data&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="s1">&#39;seo&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="n">task_context</span><span class="p">,</span>
                    <span class="s1">&#39;dependencies&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;generate&#39;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">])</span>
            
        <span class="k">elif</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;content_optimization&#39;</span><span class="p">:</span>
            <span class="c1"># Parallel optimization tasks</span>
            <span class="n">subtasks</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;technical_seo&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="s1">&#39;seo&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="n">task_context</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;analyze&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;keywords&#39;</span><span class="p">,</span> <span class="p">[]),</span>
                    <span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="s1">&#39;content&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="n">task_context</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;intent&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;keywords&#39;</span><span class="p">,</span> <span class="p">[]),</span>
                    <span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="s1">&#39;keyword&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="n">task_context</span>
                <span class="p">}</span>
            <span class="p">]</span>
            
        <span class="k">return</span> <span class="n">subtasks</span></div>

        
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_execute_subtask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subtask</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute a single subtask and return its result.&quot;&quot;&quot;</span>
        <span class="c1"># This would be implemented by the orchestrator</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="BatchExecutor">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/agents/orchestrator/orchestrator/index.html#src.seoninja.agents.orchestrator.orchestrator.BatchExecutor">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">BatchExecutor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handles batched execution of tasks with retries.&quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span> <span class="o">=</span> <span class="n">max_retries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retry_delay</span> <span class="o">=</span> <span class="n">retry_delay</span>
        
<div class="viewcode-block" id="BatchExecutor.execute">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/agents/orchestrator/orchestrator/index.html#src.seoninja.agents.orchestrator.orchestrator.BatchExecutor.execute">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tasks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">executor_func</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute tasks in batches with retry logic.&quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tasks</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">):</span>
            <span class="n">batch</span> <span class="o">=</span> <span class="n">tasks</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">]</span>
            <span class="n">batch_results</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">executor_func</span><span class="p">)</span>
            <span class="n">results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">batch_results</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">results</span></div>

        
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_execute_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">executor_func</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute a single batch with retries.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
                    <span class="o">*</span><span class="p">[</span><span class="n">executor_func</span><span class="p">(</span><span class="n">task</span><span class="p">)</span> <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">],</span>
                    <span class="n">return_exceptions</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attempt</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">retry_delay</span> <span class="o">*</span> <span class="p">(</span><span class="n">attempt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span></div>


<div class="viewcode-block" id="SEOOrchestrator">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">SEOOrchestrator</span><span class="p">(</span><span class="n">BaseAgent</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Orchestrates multiple specialized agents for SEO tasks with enhanced coordination.&quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">storage</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PersistentStorage</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">gsc_credentials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">moz_token</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">target_domain</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">openai_api_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize orchestrator with enhanced components.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;orchestrator&quot;</span><span class="p">)</span>
        
        <span class="c1"># Initialize components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="o">=</span> <span class="n">storage</span> <span class="ow">or</span> <span class="n">PersistentStorage</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gsc_credentials</span> <span class="o">=</span> <span class="n">gsc_credentials</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moz_token</span> <span class="o">=</span> <span class="n">moz_token</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_domain</span> <span class="o">=</span> <span class="n">target_domain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">openai_api_key</span> <span class="o">=</span> <span class="n">openai_api_key</span>
        
        <span class="c1"># Initialize config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;gsc_credentials&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gsc_credentials</span><span class="p">,</span>
            <span class="s1">&#39;target_domain&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_domain</span><span class="p">,</span>
            <span class="s1">&#39;moz_token&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">moz_token</span><span class="p">,</span>
            <span class="s1">&#39;openai_api_key&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">openai_api_key</span>
        <span class="p">}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">api_keys</span> <span class="o">=</span> <span class="n">APIKeyManager</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rate_limiter</span> <span class="o">=</span> <span class="n">RateLimiter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validator</span> <span class="o">=</span> <span class="n">InputValidator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_decomposer</span> <span class="o">=</span> <span class="n">TaskDecomposer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_executor</span> <span class="o">=</span> <span class="n">BatchExecutor</span><span class="p">()</span>
        
        <span class="c1"># Set up rate limits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_rate_limits</span><span class="p">()</span>
        
        <span class="c1"># Initialize empty agents dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">BaseAgent</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="c1"># Initialize monitoring intervals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitoring_interval</span> <span class="o">=</span> <span class="mi">60</span>  <span class="c1"># seconds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coordination_interval</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># seconds</span>
        
        <span class="c1"># Initialize task queue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_queue</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
        
        <span class="c1"># Load previous state if exists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_state</span><span class="p">()</span>
        
        <span class="c1"># Shared results for real-time updates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shared_results</span> <span class="o">=</span> <span class="p">{}</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">_setup_rate_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up rate limits for various services.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rate_limiter</span><span class="o">.</span><span class="n">add_limit</span><span class="p">(</span><span class="s1">&#39;openai&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>  <span class="c1"># 60 requests per minute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rate_limiter</span><span class="o">.</span><span class="n">add_limit</span><span class="p">(</span><span class="s1">&#39;moz&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>     <span class="c1"># 10 requests per minute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rate_limiter</span><span class="o">.</span><span class="n">add_limit</span><span class="p">(</span><span class="s1">&#39;gsc&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>    <span class="c1"># 100 requests per minute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rate_limiter</span><span class="o">.</span><span class="n">add_limit</span><span class="p">(</span><span class="s1">&#39;crawler&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span> <span class="c1"># 100 requests per minute</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_agents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize specialized agents with shared context.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">agents</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;crawler&#39;</span><span class="p">:</span> <span class="n">CrawlerAgent</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;domain&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_domain</span><span class="p">,</span>
                <span class="s1">&#39;rate_limit&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                <span class="s1">&#39;max_pages&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
                <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">5</span>
            <span class="p">}),</span>
            <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="n">ContentAgent</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;openai_key&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">openai_api_key</span>
            <span class="p">}),</span>
            <span class="s1">&#39;keyword&#39;</span><span class="p">:</span> <span class="n">KeywordResearchAgent</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;moz_token&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">moz_token</span><span class="p">,</span>
                <span class="s1">&#39;api_base_url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://api.keywordtool.io/v1&#39;</span><span class="p">,</span>
                <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                <span class="s1">&#39;rate_limit&#39;</span><span class="p">:</span> <span class="mf">1.0</span>
            <span class="p">}),</span>
            <span class="s1">&#39;seo&#39;</span><span class="p">:</span> <span class="n">SEOOptimizerAgent</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
        <span class="p">}</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">_load_state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load previous state from storage.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">state</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">get_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">state</span>
            
<div class="viewcode-block" id="SEOOrchestrator.execute">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.execute">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute a complex task by coordinating multiple agents with enhanced context sharing.&quot;&quot;&quot;</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Validate input</span>
            <span class="k">if</span> <span class="n">error</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_task</span><span class="p">(</span><span class="n">task</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="n">error</span><span class="p">}</span>
                
            <span class="c1"># Initialize shared context</span>
            <span class="n">shared_context</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;task_id&#39;</span><span class="p">:</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())),</span>
                <span class="s1">&#39;parent_task&#39;</span><span class="p">:</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span>
                <span class="s1">&#39;start_time&#39;</span><span class="p">:</span> <span class="n">start_time</span><span class="p">,</span>
                <span class="s1">&#39;global_parameters&#39;</span><span class="p">:</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parameters&#39;</span><span class="p">,</span> <span class="p">{}),</span>
                <span class="s1">&#39;intermediate_results&#39;</span><span class="p">:</span> <span class="p">{}</span>
            <span class="p">}</span>
            
            <span class="c1"># Decompose task</span>
            <span class="n">subtasks</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_decomposer</span><span class="o">.</span><span class="n">decompose_task</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">shared_context</span><span class="p">)</span>
            
            <span class="c1"># Execute subtasks based on task type and dependencies</span>
            <span class="k">if</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;website_analysis&#39;</span><span class="p">,</span> <span class="s1">&#39;content_optimization&#39;</span><span class="p">]:</span>
                <span class="c1"># Run parallel tasks with real-time updates</span>
                <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_parallel_tasks</span><span class="p">(</span><span class="n">subtasks</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Run sequential tasks with context preservation</span>
                <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sequential_tasks</span><span class="p">(</span><span class="n">subtasks</span><span class="p">)</span>
                
            <span class="c1"># Record metrics</span>
            <span class="n">execution_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">save_metric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;task_execution_time&#39;</span><span class="p">,</span> <span class="n">execution_time</span><span class="p">)</span>
            
            <span class="c1"># Update state with comprehensive results</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_state</span><span class="p">({</span>
                <span class="s1">&#39;last_task&#39;</span><span class="p">:</span> <span class="n">task</span><span class="p">,</span>
                <span class="s1">&#39;last_results&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">,</span>
                <span class="s1">&#39;last_execution_time&#39;</span><span class="p">:</span> <span class="n">execution_time</span><span class="p">,</span>
                <span class="s1">&#39;shared_context&#39;</span><span class="p">:</span> <span class="n">shared_context</span>
            <span class="p">})</span>
            
            <span class="c1"># Save state</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">save_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_results</span><span class="p">(</span><span class="n">task</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="n">results</span><span class="p">),</span>
                <span class="s1">&#39;execution_time&#39;</span><span class="p">:</span> <span class="n">execution_time</span><span class="p">,</span>
                <span class="s1">&#39;context&#39;</span><span class="p">:</span> <span class="n">shared_context</span>
            <span class="p">}</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log_progress</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Task execution failed: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                <span class="s1">&#39;partial_results&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_results</span>
            <span class="p">}</span></div>

            
    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate task has required fields.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;type&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">task</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Task type is required&quot;</span>
            
        <span class="k">if</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;website_analysis&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;url&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">task</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;URL is required for website analysis&quot;</span>
            <span class="k">if</span> <span class="n">error</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validator</span><span class="o">.</span><span class="n">validate_url</span><span class="p">(</span><span class="n">task</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]):</span>
                <span class="k">return</span> <span class="n">error</span>
                
        <span class="k">elif</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;content_generation&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;keyword&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">task</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;Keyword is required for content generation&quot;</span>
                
        <span class="k">elif</span> <span class="n">task</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;content_optimization&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;content&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">task</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;Content is required for optimization&quot;</span>
                
        <span class="k">return</span> <span class="kc">None</span>
        
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_execute_parallel_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subtasks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute tasks in parallel with batching and error handling.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_executor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                <span class="n">subtasks</span><span class="p">,</span>
                <span class="k">lambda</span> <span class="n">task</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_with_updates</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_results</span><span class="p">)</span>
            <span class="p">)</span>
            
            <span class="c1"># Filter out exceptions and log errors</span>
            <span class="n">processed_results</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Task execution failed: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">processed_results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                        <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                    <span class="p">})</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">processed_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                    
            <span class="k">return</span> <span class="n">processed_results</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parallel execution failed: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[{</span>
                <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Batch execution failed: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">}]</span>
            
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_execute_sequential_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subtasks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute tasks sequentially with enhanced error handling and state management.&quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_state</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">for</span> <span class="n">subtask</span> <span class="ow">in</span> <span class="n">subtasks</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Wait for dependencies with timeout</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_dependencies</span><span class="p">(</span><span class="n">subtask</span><span class="p">),</span>
                    <span class="n">timeout</span><span class="o">=</span><span class="mi">300</span>  <span class="c1"># 5 minutes timeout</span>
                <span class="p">)</span>
                
                <span class="c1"># Update task with current state</span>
                <span class="n">subtask</span><span class="p">[</span><span class="s1">&#39;context&#39;</span><span class="p">][</span><span class="s1">&#39;current_state&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_state</span>
                
                <span class="c1"># Execute task</span>
                <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_with_updates</span><span class="p">(</span><span class="n">subtask</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_results</span><span class="p">)</span>
                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                
                <span class="c1"># Update state if successful</span>
                <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">):</span>
                    <span class="n">current_state</span><span class="p">[</span><span class="n">subtask</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">shared_results</span><span class="p">[</span><span class="n">subtask</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Task </span><span class="si">{</span><span class="n">subtask</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> failed: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">subtask</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;critical&#39;</span><span class="p">):</span>
                        <span class="k">break</span>
                        
            <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>
                <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Timeout waiting for dependencies of task </span><span class="si">{</span><span class="n">subtask</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="n">error_msg</span>
                <span class="p">})</span>
                <span class="k">if</span> <span class="n">subtask</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;critical&#39;</span><span class="p">):</span>
                    <span class="k">break</span>
                    
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error executing task </span><span class="si">{</span><span class="n">subtask</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="p">})</span>
                <span class="k">if</span> <span class="n">subtask</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;critical&#39;</span><span class="p">):</span>
                    <span class="k">break</span>
                    
        <span class="k">return</span> <span class="n">results</span>
        
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_execute_with_updates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subtask</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">shared_results</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute a single task with real-time updates.&quot;&quot;&quot;</span>
        <span class="n">agent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">[</span><span class="n">subtask</span><span class="p">[</span><span class="s1">&#39;service&#39;</span><span class="p">]]</span>
        
        <span class="c1"># Add shared results to context</span>
        <span class="n">subtask</span><span class="p">[</span><span class="s1">&#39;context&#39;</span><span class="p">][</span><span class="s1">&#39;shared_results&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shared_results</span>
        
        <span class="c1"># Execute task</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">subtask</span><span class="p">)</span>
        
        <span class="c1"># Update shared results</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">):</span>
            <span class="n">shared_results</span><span class="p">[</span><span class="n">subtask</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">result</span>
        
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_wait_for_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for task dependencies with improved handling.&quot;&quot;&quot;</span>
        <span class="n">dependencies</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dependencies&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">check_interval</span> <span class="o">=</span> <span class="mf">0.1</span>
        
        <span class="k">while</span> <span class="n">dependencies</span><span class="p">:</span>
            <span class="c1"># Remove satisfied dependencies</span>
            <span class="n">dependencies</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">dep</span> <span class="k">for</span> <span class="n">dep</span> <span class="ow">in</span> <span class="n">dependencies</span> 
                <span class="k">if</span> <span class="n">dep</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_results</span>
            <span class="p">]</span>
            
            <span class="k">if</span> <span class="n">dependencies</span><span class="p">:</span>
                <span class="c1"># Check timeout</span>
                <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&gt;</span> <span class="mi">300</span><span class="p">:</span>  <span class="c1"># 5 minutes timeout</span>
                    <span class="k">raise</span> <span class="ne">TimeoutError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Timeout waiting for dependencies: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dependencies</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                    
                <span class="c1"># Exponential backoff for checking interval</span>
                <span class="n">check_interval</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">check_interval</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">check_interval</span><span class="p">)</span>
                
    <span class="k">def</span><span class="w"> </span><span class="nf">_format_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">results</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Format results based on task type with enhanced metadata.&quot;&quot;&quot;</span>
        <span class="n">formatted_results</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;task_type&#39;</span><span class="p">:</span> <span class="n">task_type</span><span class="p">,</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;results&#39;</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">}</span>
        
        <span class="k">if</span> <span class="n">task_type</span> <span class="o">==</span> <span class="s1">&#39;website_analysis&#39;</span><span class="p">:</span>
            <span class="n">formatted_results</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;structure&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{}),</span>
                <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{}),</span>
                <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="n">task_type</span> <span class="o">==</span> <span class="s1">&#39;content_generation&#39;</span><span class="p">:</span>
            <span class="n">formatted_results</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;keyword_research&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{}),</span>
                <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{}),</span>
                <span class="s1">&#39;optimization&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="n">task_type</span> <span class="o">==</span> <span class="s1">&#39;content_optimization&#39;</span><span class="p">:</span>
            <span class="n">formatted_results</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;technical_seo&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{}),</span>
                <span class="s1">&#39;content_analysis&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{}),</span>
                <span class="s1">&#39;intent_analysis&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="p">}</span>
            
        <span class="k">return</span> <span class="n">formatted_results</span>
        
<div class="viewcode-block" id="SEOOrchestrator.cleanup">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.cleanup">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clean up resources.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">agent</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span></div>


<div class="viewcode-block" id="SEOOrchestrator.run">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.run">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start the orchestrator and initialize all agents.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting SEO Orchestrator...&quot;</span><span class="p">)</span>
            
            <span class="c1"># Initialize state if not exists</span>
            <span class="k">if</span> <span class="s1">&#39;agents&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;agents&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            
            <span class="c1"># Initialize all agents</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_agents</span><span class="p">()</span>
            
            <span class="c1"># Start monitoring and coordination</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_monitoring</span><span class="p">()</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;SEO Orchestrator running&quot;</span><span class="p">)</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to start orchestrator: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span></div>


<div class="viewcode-block" id="SEOOrchestrator.shutdown">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.shutdown">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gracefully shutdown the orchestrator and all agents.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Shutting down SEO Orchestrator...&quot;</span><span class="p">)</span>
            
            <span class="c1"># Stop all running tasks</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_all_tasks</span><span class="p">()</span>
            
            <span class="c1"># Cleanup agents</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cleanup_agents</span><span class="p">()</span>
            
            <span class="c1"># Save state if needed</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_state</span><span class="p">()</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;SEO Orchestrator shutdown complete&quot;</span><span class="p">)</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error during shutdown: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span></div>


    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_agents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize all specialized agents.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Initialize each specialized agent</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">agents</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;keyword&#39;</span><span class="p">:</span> <span class="n">KeywordResearchAgent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;keyword&#39;</span><span class="p">,</span> <span class="p">{})),</span>
                <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="n">ContentAgent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="p">{})),</span>
                <span class="s1">&#39;seo&#39;</span><span class="p">:</span> <span class="n">SEOOptimizerAgent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;seo&#39;</span><span class="p">,</span> <span class="p">{})),</span>
                <span class="s1">&#39;crawler&#39;</span><span class="p">:</span> <span class="n">CrawlerAgent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;crawler&#39;</span><span class="p">,</span> <span class="p">{}))</span>
            <span class="p">}</span>
            
            <span class="c1"># Setup agent collaboration</span>
            <span class="k">for</span> <span class="n">agent_name</span><span class="p">,</span> <span class="n">agent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_setup_agent_collaboration</span><span class="p">(</span><span class="n">agent</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to initialize agents: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_start_monitoring</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start monitoring agent activities and task execution.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">monitoring_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_monitor_agents</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coordination_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_coordinate_tasks</span><span class="p">())</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to start monitoring: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_stop_all_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop all running tasks gracefully.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Cancel monitoring and coordination tasks</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;monitoring_task&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">monitoring_task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
                
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;coordination_task&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coordination_task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
                
            <span class="c1"># Wait for tasks to complete</span>
            <span class="n">pending</span> <span class="o">=</span> <span class="p">[</span><span class="n">task</span> <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">all_tasks</span><span class="p">()</span> 
                      <span class="k">if</span> <span class="n">task</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">current_task</span><span class="p">()]</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">pending</span><span class="p">,</span> <span class="n">return_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error stopping tasks: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_cleanup_agents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cleanup and shutdown all agents.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">agent_name</span><span class="p">,</span> <span class="n">agent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">agent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Add check for None</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error cleaning up </span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error during agent cleanup: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_save_state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save orchestrator and agent states.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;orchestrator&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
                <span class="s1">&#39;agents&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="n">name</span><span class="p">:</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_state</span><span class="p">()</span> 
                    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">agent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">},</span>
                <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
            <span class="p">}</span>
            
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;orchestrator_state&#39;</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Orchestrator state saved&quot;</span><span class="p">)</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to save state: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_monitor_agents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Monitor agent health and performance.&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">agent_name</span><span class="p">,</span> <span class="n">agent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">health</span> <span class="o">=</span> <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_health</span><span class="p">()</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">health</span><span class="p">[</span><span class="s1">&#39;healthy&#39;</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Agent </span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2"> health check failed: </span><span class="si">{</span><span class="n">health</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="p">)</span>
                        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_agent_failure</span><span class="p">(</span><span class="n">agent_name</span><span class="p">,</span> <span class="n">agent</span><span class="p">)</span>
                        
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitoring_interval</span><span class="p">)</span>
                
            <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in agent monitoring: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitoring_interval</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_coordinate_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Coordinate task execution between agents.&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Process task queue</span>
                <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_queue</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
                    <span class="n">task</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_task</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
                    
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coordination_interval</span><span class="p">)</span>
                
            <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in task coordination: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coordination_interval</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_setup_agent_collaboration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agent</span><span class="p">:</span> <span class="n">BaseAgent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Setup collaboration between agents.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Register for agent observations</span>
            <span class="n">agent</span><span class="o">.</span><span class="n">add_observer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            
            <span class="c1"># Share relevant context</span>
            <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">update_context</span><span class="p">({</span>
                <span class="s1">&#39;shared_storage&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="p">,</span>
                <span class="s1">&#39;global_config&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span>
                <span class="s1">&#39;orchestrator_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
            <span class="p">})</span>
            
            <span class="c1"># Setup communication channels</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_setup_communication_channels</span><span class="p">(</span><span class="n">agent</span><span class="p">)</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to setup collaboration for </span><span class="si">{</span><span class="n">agent</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_setup_communication_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agent</span><span class="p">:</span> <span class="n">BaseAgent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Setup communication channels between agents.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Register message handlers</span>
            <span class="n">agent</span><span class="o">.</span><span class="n">register_handler</span><span class="p">(</span><span class="s1">&#39;task_complete&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_task_complete</span><span class="p">)</span>
            <span class="n">agent</span><span class="o">.</span><span class="n">register_handler</span><span class="p">(</span><span class="s1">&#39;task_failed&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_task_failed</span><span class="p">)</span>
            <span class="n">agent</span><span class="o">.</span><span class="n">register_handler</span><span class="p">(</span><span class="s1">&#39;state_update&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_state_update</span><span class="p">)</span>
            
            <span class="c1"># Setup agent-specific channels</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">KeywordResearchAgent</span><span class="p">):</span>
                <span class="n">agent</span><span class="o">.</span><span class="n">register_handler</span><span class="p">(</span><span class="s1">&#39;keyword_insights&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_keyword_insights</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">ContentAgent</span><span class="p">):</span>
                <span class="n">agent</span><span class="o">.</span><span class="n">register_handler</span><span class="p">(</span><span class="s1">&#39;content_insights&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_content_insights</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">SEOOptimizerAgent</span><span class="p">):</span>
                <span class="n">agent</span><span class="o">.</span><span class="n">register_handler</span><span class="p">(</span><span class="s1">&#39;seo_insights&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_seo_insights</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">CrawlerAgent</span><span class="p">):</span>
                <span class="n">agent</span><span class="o">.</span><span class="n">register_handler</span><span class="p">(</span><span class="s1">&#39;crawl_insights&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_crawl_insights</span><span class="p">)</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to setup channels for </span><span class="si">{</span><span class="n">agent</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_handle_task_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle task completion.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">task_id</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;task_id&#39;</span><span class="p">)</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shared_results</span><span class="p">[</span><span class="n">task_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_notify_dependent_tasks</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error handling task completion: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_handle_task_failed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle task failure.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">task_id</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;task_id&#39;</span><span class="p">)</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Task </span><span class="si">{</span><span class="n">task_id</span><span class="si">}</span><span class="s2"> failed: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_task_failure</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error handling task failure: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_handle_state_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle agent state updates.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">agent_name</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agent&#39;</span><span class="p">)</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;agents&#39;</span><span class="p">][</span><span class="n">agent_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error handling state update: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_handle_keyword_insights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle keyword research insights.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shared_results</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;keyword_insights&#39;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_handle_content_insights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle content analysis insights.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shared_results</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;content_insights&#39;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_handle_seo_insights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle SEO optimization insights.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shared_results</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;seo_insights&#39;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_handle_crawl_insights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle crawler insights.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shared_results</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;crawl_insights&#39;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<div class="viewcode-block" id="SEOOrchestrator.handle_event">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.handle_event">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">handle_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle events from observed agents.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">event_type</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">event_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">handlers</span><span class="p">[</span><span class="n">event_type</span><span class="p">](</span><span class="n">event</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No handler for event type: </span><span class="si">{</span><span class="n">event_type</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error handling event from </span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_notify_dependent_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">completed_task_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Notify tasks that depend on a completed task.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Find tasks that depend on the completed task</span>
            <span class="n">dependent_tasks</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">task</span> <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_queue</span><span class="o">.</span><span class="n">_queue</span>
                <span class="k">if</span> <span class="n">completed_task_id</span> <span class="ow">in</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dependencies&#39;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="p">]</span>
            
            <span class="c1"># Update their context with the completed task&#39;s results</span>
            <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">dependent_tasks</span><span class="p">:</span>
                <span class="n">task</span><span class="p">[</span><span class="s1">&#39;context&#39;</span><span class="p">][</span><span class="s1">&#39;completed_dependencies&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="s1">&#39;context&#39;</span><span class="p">,</span> <span class="p">{}</span>
                <span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;completed_dependencies&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="o">+</span> <span class="p">[</span><span class="n">completed_task_id</span><span class="p">]</span>
                
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error notifying dependent tasks: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_handle_agent_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">agent</span><span class="p">:</span> <span class="n">BaseAgent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle agent failure.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attempting to recover agent: </span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="c1"># Try to reinitialize the agent</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reinitialize_agent</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span>
            
            <span class="c1"># Update state</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;agents&#39;</span><span class="p">][</span><span class="n">agent_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;recovered&#39;</span><span class="p">,</span>
                <span class="s1">&#39;last_failure&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                <span class="s1">&#39;recovery_attempts&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;agents&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="n">agent_name</span><span class="p">,</span> <span class="p">{}</span>
                <span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;recovery_attempts&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="p">}</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to recover agent </span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_reinitialize_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agent_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reinitialize a failed agent.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Create new instance</span>
            <span class="n">agent_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">agent_name</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">if</span> <span class="n">agent_name</span> <span class="o">==</span> <span class="s1">&#39;keyword&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">[</span><span class="n">agent_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">KeywordResearchAgent</span><span class="p">(</span><span class="n">agent_config</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">agent_name</span> <span class="o">==</span> <span class="s1">&#39;content&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">[</span><span class="n">agent_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ContentAgent</span><span class="p">(</span><span class="n">agent_config</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">agent_name</span> <span class="o">==</span> <span class="s1">&#39;seo&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">[</span><span class="n">agent_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">SEOOptimizerAgent</span><span class="p">(</span><span class="n">agent_config</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">agent_name</span> <span class="o">==</span> <span class="s1">&#39;crawler&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">[</span><span class="n">agent_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">CrawlerAgent</span><span class="p">(</span><span class="n">agent_config</span><span class="p">)</span>
            
            <span class="c1"># Setup collaboration</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_setup_agent_collaboration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">[</span><span class="n">agent_name</span><span class="p">])</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to reinitialize agent </span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_process_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process a task from the queue.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Get target agent</span>
            <span class="n">agent_name</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;service&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">agent_name</span> <span class="ow">or</span> <span class="n">agent_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid agent specified: </span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="n">agent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">[</span><span class="n">agent_name</span><span class="p">]</span>
            
            <span class="c1"># Execute task</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
            
            <span class="c1"># Handle result</span>
            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">):</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_task_complete</span><span class="p">({</span>
                    <span class="s1">&#39;task_id&#39;</span><span class="p">:</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span>
                    <span class="s1">&#39;results&#39;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span>
                <span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_task_failed</span><span class="p">({</span>
                    <span class="s1">&#39;task_id&#39;</span><span class="p">:</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span>
                    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;Unknown error&#39;</span><span class="p">)</span>
                <span class="p">})</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error processing task: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_task_failed</span><span class="p">({</span>
                <span class="s1">&#39;task_id&#39;</span><span class="p">:</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span>
                <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="p">})</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_handle_task_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle task failure.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Update task status</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;tasks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tasks&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;tasks&#39;</span><span class="p">][</span><span class="n">task_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;failed&#39;</span><span class="p">,</span>
                <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="n">error</span><span class="p">,</span>
                <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
            <span class="p">}</span>
            
            <span class="c1"># Notify dependent tasks</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_notify_task_failure</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error handling task failure: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_notify_task_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">failed_task_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Notify dependent tasks of failure.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Find dependent tasks</span>
            <span class="n">dependent_tasks</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">task</span> <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_queue</span><span class="o">.</span><span class="n">_queue</span>
                <span class="k">if</span> <span class="n">failed_task_id</span> <span class="ow">in</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dependencies&#39;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="p">]</span>
            
            <span class="c1"># Update their context</span>
            <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">dependent_tasks</span><span class="p">:</span>
                <span class="n">task</span><span class="p">[</span><span class="s1">&#39;context&#39;</span><span class="p">][</span><span class="s1">&#39;failed_dependencies&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="s1">&#39;context&#39;</span><span class="p">,</span> <span class="p">{}</span>
                <span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;failed_dependencies&#39;</span><span class="p">,</span> <span class="p">[])</span> <span class="o">+</span> <span class="p">[{</span>
                    <span class="s1">&#39;task_id&#39;</span><span class="p">:</span> <span class="n">failed_task_id</span><span class="p">,</span>
                    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="n">error</span>
                <span class="p">}]</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error notifying task failure: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="SEOOrchestrator.get_communication_flows">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.get_communication_flows">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_communication_flows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">end_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get inter-agent communication flows.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">flows</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">agent_name</span><span class="p">,</span> <span class="n">agent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">agent_flows</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_communication_history</span><span class="p">()</span>
                <span class="n">filtered_flows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_by_timerange</span><span class="p">(</span><span class="n">agent_flows</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>
                <span class="n">flows</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">filtered_flows</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;flows&#39;</span><span class="p">:</span> <span class="n">flows</span><span class="p">,</span>
                <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;total_messages&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">flows</span><span class="p">),</span>
                    <span class="s1">&#39;messages_per_agent&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count_messages_per_agent</span><span class="p">(</span><span class="n">flows</span><span class="p">),</span>
                    <span class="s1">&#39;communication_patterns&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_communication_patterns</span><span class="p">(</span><span class="n">flows</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting communication flows: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span></div>


<div class="viewcode-block" id="SEOOrchestrator.get_realtime_communication">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.get_realtime_communication">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_realtime_communication</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get real-time agent interaction data.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">current_interactions</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">agent_name</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;active_communications&#39;</span><span class="p">:</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_active_communications</span><span class="p">(),</span>
                    <span class="s1">&#39;pending_messages&#39;</span><span class="p">:</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_pending_messages</span><span class="p">(),</span>
                    <span class="s1">&#39;last_interaction&#39;</span><span class="p">:</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_last_interaction</span><span class="p">()</span>
                <span class="p">}</span>
                <span class="k">for</span> <span class="n">agent_name</span><span class="p">,</span> <span class="n">agent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                <span class="s1">&#39;interactions&#39;</span><span class="p">:</span> <span class="n">current_interactions</span><span class="p">,</span>
                <span class="s1">&#39;active_channels&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_active_channels</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting realtime communication: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span></div>


<div class="viewcode-block" id="SEOOrchestrator.get_communication_analytics">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.get_communication_analytics">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_communication_analytics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeframe</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;24h&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get communication patterns analytics.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Convert timeframe to timedelta</span>
            <span class="n">time_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_timeframe</span><span class="p">(</span><span class="n">timeframe</span><span class="p">)</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">time_range</span>

            <span class="c1"># Get communication data</span>
            <span class="n">flows</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_communication_flows</span><span class="p">(</span><span class="n">start_time</span><span class="o">.</span><span class="n">isoformat</span><span class="p">())</span>
            
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;patterns&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_communication_patterns</span><span class="p">(</span><span class="n">flows</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;flows&#39;</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;message_frequency&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_message_frequency</span><span class="p">(</span><span class="n">flows</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;flows&#39;</span><span class="p">,</span> <span class="p">[])),</span>
                    <span class="s1">&#39;response_times&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_response_times</span><span class="p">(</span><span class="n">flows</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;flows&#39;</span><span class="p">,</span> <span class="p">[])),</span>
                    <span class="s1">&#39;channel_usage&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_channel_usage</span><span class="p">(</span><span class="n">flows</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;flows&#39;</span><span class="p">,</span> <span class="p">[]))</span>
                <span class="p">},</span>
                <span class="s1">&#39;insights&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_communication_insights</span><span class="p">(</span><span class="n">flows</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;flows&#39;</span><span class="p">,</span> <span class="p">[]))</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting communication analytics: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span></div>


<div class="viewcode-block" id="SEOOrchestrator.get_data_flow_metrics">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.get_data_flow_metrics">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_data_flow_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">end_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get data flow metrics between agents.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">flows</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_communication_flows</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;data_volume&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_data_volume</span><span class="p">(</span><span class="n">flows</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;flows&#39;</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="s1">&#39;flow_patterns&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_flow_patterns</span><span class="p">(</span><span class="n">flows</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;flows&#39;</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="s1">&#39;bottlenecks&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identify_flow_bottlenecks</span><span class="p">(</span><span class="n">flows</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;flows&#39;</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="s1">&#39;optimization_suggestions&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_flow_optimization_suggestions</span><span class="p">(</span><span class="n">flows</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;flows&#39;</span><span class="p">,</span> <span class="p">[]))</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting data flow metrics: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span></div>


    <span class="c1"># Process Timeline Methods</span>
<div class="viewcode-block" id="SEOOrchestrator.get_process_timeline">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.get_process_timeline">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_process_timeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">process_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">include_details</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get detailed process stage tracking data.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;processes&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">process_id</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">process</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Process not found&#39;</span><span class="p">}</span>

            <span class="n">timeline</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;process_id&#39;</span><span class="p">:</span> <span class="n">process_id</span><span class="p">,</span>
                <span class="s1">&#39;stages&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_process_stages</span><span class="p">(</span><span class="n">process_id</span><span class="p">),</span>
                <span class="s1">&#39;current_stage&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_current_stage</span><span class="p">(</span><span class="n">process_id</span><span class="p">),</span>
                <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_process_duration</span><span class="p">(</span><span class="n">process_id</span><span class="p">),</span>
                <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_process_status</span><span class="p">(</span><span class="n">process_id</span><span class="p">)</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">include_details</span><span class="p">:</span>
                <span class="n">timeline</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                    <span class="s1">&#39;stage_details&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_stage_details</span><span class="p">(</span><span class="n">process_id</span><span class="p">),</span>
                    <span class="s1">&#39;dependencies&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_process_dependencies</span><span class="p">(</span><span class="n">process_id</span><span class="p">),</span>
                    <span class="s1">&#39;resources&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_process_resources</span><span class="p">(</span><span class="n">process_id</span><span class="p">)</span>
                <span class="p">})</span>

            <span class="k">return</span> <span class="n">timeline</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting process timeline: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span></div>


<div class="viewcode-block" id="SEOOrchestrator.get_decision_points">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.get_decision_points">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_decision_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">process_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">start_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">end_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get decision point logging data.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">decisions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_process_decisions</span><span class="p">(</span><span class="n">process_id</span><span class="p">)</span>
            <span class="n">filtered_decisions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_by_timerange</span><span class="p">(</span><span class="n">decisions</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;process_id&#39;</span><span class="p">:</span> <span class="n">process_id</span><span class="p">,</span>
                <span class="s1">&#39;decisions&#39;</span><span class="p">:</span> <span class="n">filtered_decisions</span><span class="p">,</span>
                <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;total_decisions&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_decisions</span><span class="p">),</span>
                    <span class="s1">&#39;decision_types&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_decision_types</span><span class="p">(</span><span class="n">filtered_decisions</span><span class="p">),</span>
                    <span class="s1">&#39;average_decision_time&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_average_decision_time</span><span class="p">(</span><span class="n">filtered_decisions</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting decision points: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span></div>


<div class="viewcode-block" id="SEOOrchestrator.get_stage_transitions">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.get_stage_transitions">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_stage_transitions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">process_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get stage transition data.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">transitions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_stage_transitions</span><span class="p">(</span><span class="n">process_id</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;process_id&#39;</span><span class="p">:</span> <span class="n">process_id</span><span class="p">,</span>
                <span class="s1">&#39;transitions&#39;</span><span class="p">:</span> <span class="n">transitions</span><span class="p">,</span>
                <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;total_transitions&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">transitions</span><span class="p">),</span>
                    <span class="s1">&#39;average_stage_duration&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_average_stage_duration</span><span class="p">(</span><span class="n">transitions</span><span class="p">),</span>
                    <span class="s1">&#39;bottleneck_stages&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identify_bottleneck_stages</span><span class="p">(</span><span class="n">transitions</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting stage transitions: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span></div>


<div class="viewcode-block" id="SEOOrchestrator.get_time_analysis">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.get_time_analysis">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_time_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeframe</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">process_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get time-based process analysis.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">time_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_timeframe</span><span class="p">(</span><span class="n">timeframe</span><span class="p">)</span>
            <span class="n">processes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_processes_in_timeframe</span><span class="p">(</span><span class="n">time_range</span><span class="p">,</span> <span class="n">process_type</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;timeframe&#39;</span><span class="p">:</span> <span class="n">timeframe</span><span class="p">,</span>
                <span class="s1">&#39;process_type&#39;</span><span class="p">:</span> <span class="n">process_type</span><span class="p">,</span>
                <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;average_duration&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_average_process_duration</span><span class="p">(</span><span class="n">processes</span><span class="p">),</span>
                    <span class="s1">&#39;completion_rate&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_completion_rate</span><span class="p">(</span><span class="n">processes</span><span class="p">),</span>
                    <span class="s1">&#39;stage_distribution&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_stage_distribution</span><span class="p">(</span><span class="n">processes</span><span class="p">)</span>
                <span class="p">},</span>
                <span class="s1">&#39;trends&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_time_trends</span><span class="p">(</span><span class="n">processes</span><span class="p">),</span>
                <span class="s1">&#39;optimization_suggestions&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_time_optimization_suggestions</span><span class="p">(</span><span class="n">processes</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting time analysis: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span></div>


    <span class="c1"># Resource Monitoring Methods</span>
<div class="viewcode-block" id="SEOOrchestrator.get_resource_allocation">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.get_resource_allocation">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_resource_allocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timeframe</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;1h&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get detailed resource allocation tracking.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">time_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_timeframe</span><span class="p">(</span><span class="n">timeframe</span><span class="p">)</span>
            <span class="n">allocations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_resource_allocations</span><span class="p">(</span><span class="n">time_range</span><span class="p">,</span> <span class="n">resource_type</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;resource_type&#39;</span><span class="p">:</span> <span class="n">resource_type</span><span class="p">,</span>
                <span class="s1">&#39;timeframe&#39;</span><span class="p">:</span> <span class="n">timeframe</span><span class="p">,</span>
                <span class="s1">&#39;allocations&#39;</span><span class="p">:</span> <span class="n">allocations</span><span class="p">,</span>
                <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;utilization&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_resource_utilization</span><span class="p">(</span><span class="n">allocations</span><span class="p">),</span>
                    <span class="s1">&#39;efficiency&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_resource_efficiency</span><span class="p">(</span><span class="n">allocations</span><span class="p">),</span>
                    <span class="s1">&#39;availability&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_resource_availability</span><span class="p">(</span><span class="n">allocations</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting resource allocation: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span></div>


<div class="viewcode-block" id="SEOOrchestrator.get_usage_patterns">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.get_usage_patterns">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_usage_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">start_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">end_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get resource usage patterns.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">usage_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_resource_usage</span><span class="p">(</span><span class="n">resource_type</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;resource_type&#39;</span><span class="p">:</span> <span class="n">resource_type</span><span class="p">,</span>
                <span class="s1">&#39;patterns&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_usage_patterns</span><span class="p">(</span><span class="n">usage_data</span><span class="p">),</span>
                <span class="s1">&#39;trends&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_usage_trends</span><span class="p">(</span><span class="n">usage_data</span><span class="p">),</span>
                <span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_future_usage</span><span class="p">(</span><span class="n">usage_data</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting usage patterns: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span></div>


<div class="viewcode-block" id="SEOOrchestrator.get_resource_bottlenecks">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.get_resource_bottlenecks">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_resource_bottlenecks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">analysis_period</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;24h&#39;</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get resource bottleneck identification.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">time_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_timeframe</span><span class="p">(</span><span class="n">analysis_period</span><span class="p">)</span>
            <span class="n">usage_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_resource_usage</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">time_range</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">())</span>
            
            <span class="n">bottlenecks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identify_bottlenecks</span><span class="p">(</span><span class="n">usage_data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;bottlenecks&#39;</span><span class="p">:</span> <span class="n">bottlenecks</span><span class="p">,</span>
                <span class="s1">&#39;impact_analysis&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_bottleneck_impact</span><span class="p">(</span><span class="n">bottlenecks</span><span class="p">),</span>
                <span class="s1">&#39;recommendations&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_bottleneck_recommendations</span><span class="p">(</span><span class="n">bottlenecks</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting resource bottlenecks: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span></div>


<div class="viewcode-block" id="SEOOrchestrator.get_system_capacity">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.get_system_capacity">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_system_capacity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_predictions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get system capacity metrics.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">current_capacity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_current_capacity</span><span class="p">()</span>
            <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;current_capacity&#39;</span><span class="p">:</span> <span class="n">current_capacity</span><span class="p">,</span>
                <span class="s1">&#39;utilization&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_system_utilization</span><span class="p">(),</span>
                <span class="s1">&#39;headroom&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_system_headroom</span><span class="p">(),</span>
                <span class="s1">&#39;limits&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_system_limits</span><span class="p">()</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">include_predictions</span><span class="p">:</span>
                <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;future_capacity&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_future_capacity</span><span class="p">(),</span>
                    <span class="s1">&#39;growth_trends&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_capacity_trends</span><span class="p">(),</span>
                    <span class="s1">&#39;scaling_recommendations&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_scaling_recommendations</span><span class="p">()</span>
                <span class="p">}</span>

            <span class="k">return</span> <span class="n">metrics</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting system capacity: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span></div>


<div class="viewcode-block" id="SEOOrchestrator.get_realtime_resource_metrics">
<a class="viewcode-back" href="../../../../../autoapi/src/seoninja/index.html#src.seoninja.agents.orchestrator.orchestrator.SEOOrchestrator.get_realtime_resource_metrics">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_realtime_resource_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get real-time resource metrics.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                <span class="s1">&#39;cpu_usage&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cpu_usage</span><span class="p">(),</span>
                <span class="s1">&#39;memory_usage&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_memory_usage</span><span class="p">(),</span>
                <span class="s1">&#39;network_usage&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_network_usage</span><span class="p">(),</span>
                <span class="s1">&#39;agent_resources&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_agent_resource_usage</span><span class="p">(),</span>
                <span class="s1">&#39;queue_metrics&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_queue_metrics</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting realtime resource metrics: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span></div>


    <span class="c1"># Helper Methods</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_filter_by_timerange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">start_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">end_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter data by time range.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">start_time</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">end_time</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">data</span>

        <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">if</span> <span class="n">start_time</span><span class="p">:</span>
            <span class="n">start_dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">start_time</span><span class="p">)</span>
            <span class="n">filtered_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">filtered_data</span> <span class="k">if</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="n">start_dt</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">end_time</span><span class="p">:</span>
            <span class="n">end_dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">end_time</span><span class="p">)</span>
            <span class="n">filtered_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">filtered_data</span> <span class="k">if</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">end_dt</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">filtered_data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_parse_timeframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeframe</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">timedelta</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse timeframe string into timedelta.&quot;&quot;&quot;</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="n">timeframe</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timeframe</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;h&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">unit</span> <span class="o">==</span> <span class="s1">&#39;w&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">weeks</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid timeframe format: </span><span class="si">{</span><span class="n">timeframe</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Private Helper Methods for Communication Analysis</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_count_messages_per_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Count messages per agent.&quot;&quot;&quot;</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">flow</span> <span class="ow">in</span> <span class="n">flows</span><span class="p">:</span>
            <span class="n">counts</span><span class="p">[</span><span class="n">flow</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">flow</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">counts</span><span class="p">[</span><span class="n">flow</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">flow</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">counts</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_analyze_communication_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze communication patterns between agents.&quot;&quot;&quot;</span>
        <span class="n">patterns</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;common_paths&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identify_common_paths</span><span class="p">(</span><span class="n">flows</span><span class="p">),</span>
            <span class="s1">&#39;frequency_matrix&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_frequency_matrix</span><span class="p">(</span><span class="n">flows</span><span class="p">),</span>
            <span class="s1">&#39;peak_times&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identify_peak_times</span><span class="p">(</span><span class="n">flows</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">patterns</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_identify_common_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Identify common communication paths.&quot;&quot;&quot;</span>
        <span class="n">path_counts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">flow</span> <span class="ow">in</span> <span class="n">flows</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">flow</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">-&gt;</span><span class="si">{</span><span class="n">flow</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">path_counts</span><span class="p">[</span><span class="n">path</span><span class="p">]</span> <span class="o">=</span> <span class="n">path_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="p">[{</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">k</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="n">v</span><span class="p">}</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">path_counts</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_frequency_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create communication frequency matrix.&quot;&quot;&quot;</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">flow</span> <span class="ow">in</span> <span class="n">flows</span><span class="p">:</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">flow</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">flow</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">source</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">matrix</span><span class="p">:</span>
                <span class="n">matrix</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">matrix</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="n">target</span><span class="p">]</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">[</span><span class="n">source</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">matrix</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_identify_peak_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Identify peak communication times.&quot;&quot;&quot;</span>
        <span class="n">hour_counts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">flow</span> <span class="ow">in</span> <span class="n">flows</span><span class="p">:</span>
            <span class="n">hour</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">flow</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">hour</span>
            <span class="n">hour_counts</span><span class="p">[</span><span class="n">hour</span><span class="p">]</span> <span class="o">=</span> <span class="n">hour_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">hour</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="p">[{</span><span class="s1">&#39;hour&#39;</span><span class="p">:</span> <span class="n">k</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="n">v</span><span class="p">}</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">hour_counts</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>

    <span class="c1"># Private Helper Methods for Process Timeline</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_process_stages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">process_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all stages of a process.&quot;&quot;&quot;</span>
        <span class="n">process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;processes&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">process_id</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">return</span> <span class="n">process</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;stages&#39;</span><span class="p">,</span> <span class="p">[])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_stage_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stage</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate duration of a single stage.&quot;&quot;&quot;</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">stage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;start_time&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()))</span>
        <span class="n">end_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">stage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;end_time&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_process_decisions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">process_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get decision points for a process.&quot;&quot;&quot;</span>
        <span class="n">process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;processes&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">process_id</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">return</span> <span class="n">process</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;decisions&#39;</span><span class="p">,</span> <span class="p">[])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_analyze_decision_types</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">decisions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze types of decisions made.&quot;&quot;&quot;</span>
        <span class="n">type_counts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">decision</span> <span class="ow">in</span> <span class="n">decisions</span><span class="p">:</span>
            <span class="n">decision_type</span> <span class="o">=</span> <span class="n">decision</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">)</span>
            <span class="n">type_counts</span><span class="p">[</span><span class="n">decision_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">decision_type</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">type_counts</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_average_decision_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">decisions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate average time taken for decisions.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">decisions</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="n">times</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">decision</span> <span class="ow">in</span> <span class="n">decisions</span><span class="p">:</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">decision</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;start_time&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="n">end_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">decision</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;end_time&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">times</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span> <span class="k">if</span> <span class="n">times</span> <span class="k">else</span> <span class="mf">0.0</span>

    <span class="c1"># Private Helper Methods for Resource Monitoring</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_resource_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">start_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">end_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get resource usage data.&quot;&quot;&quot;</span>
        <span class="n">usage_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resource_usage&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">filtered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_by_timerange</span><span class="p">(</span><span class="n">usage_data</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">resource_type</span><span class="p">:</span>
            <span class="n">filtered</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">filtered</span> <span class="k">if</span> <span class="n">u</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">resource_type</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">filtered</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_analyze_usage_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">usage_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze resource usage patterns.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;peak_usage_times&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identify_peak_usage_times</span><span class="p">(</span><span class="n">usage_data</span><span class="p">),</span>
            <span class="s1">&#39;usage_distribution&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_usage_distribution</span><span class="p">(</span><span class="n">usage_data</span><span class="p">),</span>
            <span class="s1">&#39;correlation_analysis&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyze_usage_correlation</span><span class="p">(</span><span class="n">usage_data</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_identify_peak_usage_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">usage_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Identify times of peak resource usage.&quot;&quot;&quot;</span>
        <span class="n">hour_usage</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">usage_data</span><span class="p">:</span>
            <span class="n">hour</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">hour</span>
            <span class="n">usage</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;utilization&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">hour</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hour_usage</span><span class="p">:</span>
                <span class="n">hour_usage</span><span class="p">[</span><span class="n">hour</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">hour_usage</span><span class="p">[</span><span class="n">hour</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">usage</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">[{</span>
            <span class="s1">&#39;hour&#39;</span><span class="p">:</span> <span class="n">hour</span><span class="p">,</span>
            <span class="s1">&#39;average_usage&#39;</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">usages</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">usages</span><span class="p">),</span>
            <span class="s1">&#39;peak_usage&#39;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">usages</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">for</span> <span class="n">hour</span><span class="p">,</span> <span class="n">usages</span> <span class="ow">in</span> <span class="n">hour_usage</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_usage_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">usage_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate distribution of resource usage.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">usage_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>
        
        <span class="n">usages</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;utilization&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">usage_data</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="n">usages</span><span class="p">),</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">usages</span><span class="p">),</span>
            <span class="s1">&#39;average&#39;</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">usages</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">usages</span><span class="p">),</span>
            <span class="s1">&#39;median&#39;</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">usages</span><span class="p">)[</span><span class="nb">len</span><span class="p">(</span><span class="n">usages</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_analyze_usage_correlation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">usage_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze correlation between different resource metrics.&quot;&quot;&quot;</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">usage_data</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="n">metric</span> <span class="o">!=</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">metric</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">:</span>
                        <span class="n">metrics</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">metrics</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        
        <span class="n">correlations</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">m1</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">m2</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">m1</span> <span class="o">&lt;</span> <span class="n">m2</span><span class="p">:</span>  <span class="c1"># Avoid duplicate correlations</span>
                    <span class="n">correlation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_correlation</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="n">m1</span><span class="p">],</span> <span class="n">metrics</span><span class="p">[</span><span class="n">m2</span><span class="p">])</span>
                    <span class="n">correlations</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m1</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">m2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">correlation</span>
        
        <span class="k">return</span> <span class="n">correlations</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_correlation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">y</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate correlation coefficient between two metrics.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        
        <span class="n">mean_x</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">mean_y</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        
        <span class="n">numerator</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">xi</span> <span class="o">-</span> <span class="n">mean_x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">yi</span> <span class="o">-</span> <span class="n">mean_y</span><span class="p">)</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="n">denominator</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">xi</span> <span class="o">-</span> <span class="n">mean_x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">((</span><span class="n">yi</span> <span class="o">-</span> <span class="n">mean_y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">yi</span> <span class="ow">in</span> <span class="n">y</span><span class="p">))</span> <span class="o">**</span> <span class="mf">0.5</span>
        
        <span class="k">return</span> <span class="n">numerator</span> <span class="o">/</span> <span class="n">denominator</span> <span class="k">if</span> <span class="n">denominator</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>

    <span class="c1"># System Metrics Collection Methods</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_cpu_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get CPU usage metrics.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cpu_times</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">cpu_times_percent</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;utilization&#39;</span><span class="p">:</span> <span class="n">psutil</span><span class="o">.</span><span class="n">cpu_percent</span><span class="p">()</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span>
                <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="n">cpu_times</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
                <span class="s1">&#39;system&#39;</span><span class="p">:</span> <span class="n">cpu_times</span><span class="o">.</span><span class="n">system</span><span class="p">,</span>
                <span class="s1">&#39;idle&#39;</span><span class="p">:</span> <span class="n">cpu_times</span><span class="o">.</span><span class="n">idle</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting CPU usage: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_memory_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get memory usage metrics.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">memory</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">virtual_memory</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;utilization&#39;</span><span class="p">:</span> <span class="n">memory</span><span class="o">.</span><span class="n">percent</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span>
                <span class="s1">&#39;available&#39;</span><span class="p">:</span> <span class="n">memory</span><span class="o">.</span><span class="n">available</span><span class="p">,</span>
                <span class="s1">&#39;used&#39;</span><span class="p">:</span> <span class="n">memory</span><span class="o">.</span><span class="n">used</span><span class="p">,</span>
                <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="n">memory</span><span class="o">.</span><span class="n">total</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting memory usage: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_network_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get network usage metrics.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">network</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">net_io_counters</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;bytes_sent&#39;</span><span class="p">:</span> <span class="n">network</span><span class="o">.</span><span class="n">bytes_sent</span><span class="p">,</span>
                <span class="s1">&#39;bytes_recv&#39;</span><span class="p">:</span> <span class="n">network</span><span class="o">.</span><span class="n">bytes_recv</span><span class="p">,</span>
                <span class="s1">&#39;packets_sent&#39;</span><span class="p">:</span> <span class="n">network</span><span class="o">.</span><span class="n">packets_sent</span><span class="p">,</span>
                <span class="s1">&#39;packets_recv&#39;</span><span class="p">:</span> <span class="n">network</span><span class="o">.</span><span class="n">packets_recv</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting network usage: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_storage_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get storage usage metrics.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">disk</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">disk_usage</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;utilization&#39;</span><span class="p">:</span> <span class="n">disk</span><span class="o">.</span><span class="n">percent</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span>
                <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="n">disk</span><span class="o">.</span><span class="n">total</span><span class="p">,</span>
                <span class="s1">&#39;used&#39;</span><span class="p">:</span> <span class="n">disk</span><span class="o">.</span><span class="n">used</span><span class="p">,</span>
                <span class="s1">&#39;free&#39;</span><span class="p">:</span> <span class="n">disk</span><span class="o">.</span><span class="n">free</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting storage usage: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_agent_resource_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get resource usage per agent.&quot;&quot;&quot;</span>
        <span class="n">usage</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">agent_name</span><span class="p">,</span> <span class="n">agent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="s1">&#39;get_resource_usage&#39;</span><span class="p">):</span>
                    <span class="n">usage</span><span class="p">[</span><span class="n">agent_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_resource_usage</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting resource usage for agent </span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">usage</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_queue_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get task queue metrics.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;queue_size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_queue</span><span class="o">.</span><span class="n">qsize</span><span class="p">(),</span>
                <span class="s1">&#39;active_tasks&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tasks&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> 
                                   <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;running&#39;</span><span class="p">]),</span>
                <span class="s1">&#39;pending_tasks&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">([</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tasks&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> 
                                    <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;pending&#39;</span><span class="p">])</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting queue metrics: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_cpu_max_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get CPU maximum frequency.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">psutil</span><span class="o">.</span><span class="n">cpu_freq</span><span class="p">()</span><span class="o">.</span><span class="n">max</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting CPU max frequency: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mf">0.0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_network_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get network interface limits.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">interfaces</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">net_if_stats</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="n">name</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="n">interface</span><span class="o">.</span><span class="n">speed</span><span class="p">,</span>
                    <span class="s1">&#39;mtu&#39;</span><span class="p">:</span> <span class="n">interface</span><span class="o">.</span><span class="n">mtu</span><span class="p">,</span>
                    <span class="s1">&#39;is_up&#39;</span><span class="p">:</span> <span class="n">interface</span><span class="o">.</span><span class="n">isup</span>
                <span class="p">}</span>
                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">interface</span> <span class="ow">in</span> <span class="n">interfaces</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting network limits: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_predict_future_capacity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict future system capacity needs.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">current_usage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_current_capacity</span><span class="p">()</span>
            <span class="n">historical_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;historical_usage&#39;</span><span class="p">,</span> <span class="p">[])</span>
            
            <span class="n">predictions</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;cpu&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_resource_usage</span><span class="p">(</span><span class="n">historical_data</span><span class="p">,</span> <span class="s1">&#39;cpu&#39;</span><span class="p">),</span>
                <span class="s1">&#39;memory&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_resource_usage</span><span class="p">(</span><span class="n">historical_data</span><span class="p">,</span> <span class="s1">&#39;memory&#39;</span><span class="p">),</span>
                <span class="s1">&#39;storage&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_resource_usage</span><span class="p">(</span><span class="n">historical_data</span><span class="p">,</span> <span class="s1">&#39;storage&#39;</span><span class="p">),</span>
                <span class="s1">&#39;network&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_resource_usage</span><span class="p">(</span><span class="n">historical_data</span><span class="p">,</span> <span class="s1">&#39;network&#39;</span><span class="p">)</span>
            <span class="p">}</span>
            
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;current_usage&#39;</span><span class="p">:</span> <span class="n">current_usage</span><span class="p">,</span>
                <span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">predictions</span><span class="p">,</span>
                <span class="s1">&#39;recommendation&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_capacity_recommendation</span><span class="p">(</span><span class="n">current_usage</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error predicting future capacity: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_predict_resource_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">historical_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span> <span class="n">resource_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict future usage for a specific resource.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">historical_data</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{}</span>
            
            <span class="c1"># Get usage trends</span>
            <span class="n">usage_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">resource_type</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;utilization&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> 
                          <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">historical_data</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">usage_values</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{}</span>
            
            <span class="c1"># Simple linear regression for prediction</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">usage_values</span><span class="p">)))</span>
            <span class="n">slope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_slope</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">usage_values</span><span class="p">)</span>
            
            <span class="c1"># Predict next 24 hours</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">usage_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;1h&#39;</span><span class="p">:</span> <span class="n">current</span> <span class="o">+</span> <span class="n">slope</span><span class="p">,</span>
                <span class="s1">&#39;6h&#39;</span><span class="p">:</span> <span class="n">current</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
                <span class="s1">&#39;24h&#39;</span><span class="p">:</span> <span class="n">current</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="mi">24</span>
            <span class="p">}</span>
            
            <span class="k">return</span> <span class="n">predictions</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error predicting resource usage: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_calculate_slope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">y</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate slope for linear regression.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        
        <span class="n">mean_x</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">mean_y</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        
        <span class="n">numerator</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">xi</span> <span class="o">-</span> <span class="n">mean_x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">yi</span> <span class="o">-</span> <span class="n">mean_y</span><span class="p">)</span> <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="n">denominator</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">xi</span> <span class="o">-</span> <span class="n">mean_x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">numerator</span> <span class="o">/</span> <span class="n">denominator</span> <span class="k">if</span> <span class="n">denominator</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_capacity_recommendation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_usage</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">predictions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate capacity scaling recommendations.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">recommendations</span> <span class="o">=</span> <span class="p">{}</span>
            
            <span class="k">for</span> <span class="n">resource</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="s1">&#39;memory&#39;</span><span class="p">,</span> <span class="s1">&#39;storage&#39;</span><span class="p">,</span> <span class="s1">&#39;network&#39;</span><span class="p">]:</span>
                <span class="n">current</span> <span class="o">=</span> <span class="n">current_usage</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;utilization&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">predicted</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;24h&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="n">predicted</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>  <span class="c1"># 80% threshold</span>
                    <span class="n">recommendations</span><span class="p">[</span><span class="n">resource</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;scale_up&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;urgency&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span> <span class="k">if</span> <span class="n">predicted</span> <span class="o">&gt;</span> <span class="mf">0.9</span> <span class="k">else</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Predicted utilization of </span><span class="si">{</span><span class="n">predicted</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2"> exceeds threshold&quot;</span>
                    <span class="p">}</span>
                <span class="k">elif</span> <span class="n">predicted</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">:</span>  <span class="c1"># 20% threshold</span>
                    <span class="n">recommendations</span><span class="p">[</span><span class="n">resource</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;scale_down&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;urgency&#39;</span><span class="p">:</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Predicted utilization of </span><span class="si">{</span><span class="n">predicted</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2"> is below optimal&quot;</span>
                    <span class="p">}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">recommendations</span><span class="p">[</span><span class="n">resource</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;maintain&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;urgency&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;reason&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Predicted utilization of </span><span class="si">{</span><span class="n">predicted</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2"> is optimal&quot;</span>
                    <span class="p">}</span>
            
            <span class="k">return</span> <span class="n">recommendations</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error generating capacity recommendations: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clean up resources.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">agent</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span> </div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Your Name.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>